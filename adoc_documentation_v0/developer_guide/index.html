<!doctype html>
<html itemscope itemtype="http://schema.org/Product" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title></title>

    <meta itemprop="name" content="Transfuse"/>
    <meta itemprop="description" content="A Dependency Injection and Integration framework for Google Android"/>
    <meta itemprop="image" content="http://androidtransfuse.org/images/icon_medium.png"/>
    <meta itemprop="url" content="/shelley/"/>
    <meta name="author" content="John Ericksen"/>
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@attransfuse" />
    <meta name="twitter:title" content="Transfuse: A dependency injection framework for Google Android." />
    <meta name="twitter:description" content="Transfuse is a Java Dependency Injection (DI) and integration library geared specifically for the Google Android API." />
    <meta name="twitter:image" content="http://androidtransfuse.org/images/icon_medium.png" />

    <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/shelley/css/foundation.css"/>
    <link rel="stylesheet" href="/shelley/css/coderay.css"/>
    <link rel="stylesheet" href="/shelley/css/transfuse.css"/>
    <script src="/shelley/js/main.js"></script>
    <script src="/shelley/js/vendor/modernizr.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
</head>
<body>

<div class="row">
    <div class="column">
        <h2 class="remove-bottom" style="margin-top: 10px"><img src="/shelley/images/icon.png"/><a class="title" href="/shelley/index.html" >Transfuse</a></h2>
        for Google Android

        <div id="socialwidget">
            <a class="image" href="https://gitter.im/johncarl81/transfuse?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge"><img src="https://badges.gitter.im/johncarl81/transfuse.svg" alt="Transfuse Gitter"></a>
            <a href="https://twitter.com/attransfuse" class="twitter-follow-button" data-show-count="false">Follow @attransfuse</a>
            <div class="g-plusone" data-size="medium" data-href="http://androidtransfuse.org/"></div>
        </div>
        <hr />
    </div>
</div>

<div class="row">
    <div class="large-3 column">
        <ul class="nav">
            <li><a href="/shelley/index.html">About</a></li>
            <li><a href="/shelley//adoc_documentation/developer_guide/index.html">Dev guide</a></li>
            <li><a href="/shelley/getting_started.html">Getting Started</a></li>
            <li><span id="documentationtoggle" class="arrow arrowright"></span><a href="/shelley/documentation.html">Documentation</a>
                <ul id="documentation" class="nav">
                    <li><a href="/shelley/documentation.html#introduction">Introduction</a></li>
                    <li><a href="/shelley/documentation.html#activity">@Activity</a></li>
                    <li><a href="/shelley/documentation.html#fragment">@Fragment</a></li>
                    <li><a href="/shelley/documentation.html#service">@Service</a></li>
                    <li><a href="/shelley/documentation.html#broadcastreceiver">@BroadcastReceiver</a></li>
                    <li><a href="/shelley/documentation.html#application">@Application</a></li>
                    <li><a href="/shelley/documentation.html#intent_factory">Intent Factory</a></li>
                    <li><a href="/shelley/documentation.html#dependency_injection_di">Dependency Injection</a></li>
                    <li><a href="/shelley/documentation.html#method_interceptors">Method Interceptors</a></li>
                    <li><a href="/shelley/documentation.html#configuration">Configuration</a></li>
                    <li><a href="/shelley/documentation.html#events">Events</a></li>
                    <li><a href="/shelley/documentation.html#factory">@Factory</a></li>
                    <li><a href="/shelley/documentation.html#legacy_support">Legacy Support</a></li>
                    <li><a href="/shelley/documentation.html#reference">Reference</a></li>
                </ul>
            </li>
            <li><a href="https://oss.sonatype.org/service/local/repositories/releases/archive/org/androidtransfuse/transfuse-api//transfuse-api--javadoc.jar/!/index.html">API Javadocs</a></li>
            <li><a href="http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22org.androidtransfuse%22">Download</a></li>
        </ul>
    </div>
    <div class="large-9 column">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title"></h1>
  </header>

  <div class="post-content">
    <div id="toc" class="toc">
<div id="toctitle">User Guide</div>
<ul class="sectlevel1">
<li><a href="#versioning">1. Versioning</a>
<ul class="sectlevel2">
<li><a href="#version-numbers">1.1. Version numbers</a></li>
<li><a href="#releasing-version">1.2. Releasing Version</a>
<ul class="sectlevel3">
<li><a href="#in-the-source-repository-operatorfabric-core">1.2.1. In the source repository (operatorfabric-core)</a></li>
<li><a href="#checking-deploy-docker-compose">1.2.2. Checking deploy docker-compose</a></li>
<li><a href="#in-the-documentation-repository-opfab-github-io">1.2.3. In the documentation repository (opfab.github.io)</a></li>
<li><a href="#in-jira">1.2.4. In Jira</a></li>
</ul>
</li>
<li><a href="#advertising-the-new-release-opfab-github-io-and-mailing-list">1.3. Advertising the new release (opfab.github.io and mailing list)</a></li>
<li><a href="#preparing-next-version">1.4. Preparing next version</a>
<ul class="sectlevel3">
<li><a href="#in-the-source-repository-operatorfabric-core-2">1.4.1. In the source repository (operatorfabric-core)</a></li>
<li><a href="#in-the-documentation-repository-opfab-github-io-2">1.4.2. In the documentation repository (opfab.github.io)</a></li>
<li><a href="#in-jira-2">1.4.3. In Jira</a></li>
<li><a href="#checking-dockerhub-the-following-day">1.4.4. Checking DockerHub the following day</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="versioning">1. Versioning</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="version-numbers">1.1. Version numbers</h3>
<div class="paragraph">
<p>Version numbers X.Y.Z.label should be understood like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>X: Major version, a major version adds new features and breaks compatibility with previous major and minor versions.</p>
</li>
<li>
<p>Y: Minor version, a minor version adds new features and does not break compatibility with previous minor versions for
the same major version.</p>
</li>
<li>
<p>Z: Patch, a patch version only contains bug fixes of current minor version</p>
</li>
<li>
<p>Label: pre-release or build metadata:</p>
<div class="ulist">
<ul>
<li>
<p>SNAPSHOT: a version whose development is in progress, nightly builds only deliver SNAPSHOT versions</p>
</li>
<li>
<p>RELEASE: a version whose development is finished</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="releasing-version">1.2. Releasing Version</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
To release a version we use some Travis dedicated jobs. These jobs are triggered by specific commit keywords and rely
on the VERSION file at the root of this repository to know which version is being produced.
It is thus crucial to double-check the content of this file before any push (triggering the Travis jobs) is made.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before releasing a version, you need to prepare the release.</p>
</div>
<div class="paragraph">
<p>Considering a version X.X.X.SNAPSHOT.</p>
</div>
<div class="sect3">
<h4 id="in-the-source-repository-operatorfabric-core">1.2.1. In the source repository (operatorfabric-core)</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use the ./CICD/prepare_release_version.sh script to automatically perform all the necessary changes:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>./CICD/prepare_release_version.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will perform the following changes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Replace X.X.X.SNAPSHOT with X.X.X.RELEASE in *.adoc, swagger.yaml files and the VERSION file at the root operator-fabric folder</p>
</li>
<li>
<p>Update the revision date in *.adoc files (by default, the new revision date is today, but see the script usage for details)</p>
</li>
<li>
<p>Change the version from W.W.W.RELEASE (previous release) to X.X.X.RELEASE in the deploy docker-compose file</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The VERSION file is particularly important as the CI/CD pipeline tasks
(building the documentation and the docker images for example) are based on it.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Commit with the template message:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[RELEASE] X.X.X.RELEASE (ci_docker,ci_documentation)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The commit comment leverages these three keywords to trigger the delivery of documentation and docker images, so you should
check that they are correctly spelt.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ci_docker: triggers the build and upload of versioned docker images to dockerhub</p>
</li>
<li>
<p>ci_documentation: triggers the build and upload of the current documentation</p>
</li>
</ul>
</div>
</li>
<li>
<p>Tag the commit with the version</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>git tag X.X.X.RELEASE</code></pre>
</div>
</div>
</li>
<li>
<p>Push the commit</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>git push</code></pre>
</div>
</div>
</li>
<li>
<p>Push the tag</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>git push origin X.X.X.RELEASE</code></pre>
</div>
</div>
</li>
<li>
<p>Check that the build is correctly triggered</p>
<div class="paragraph">
<p>You can check the status of the build job triggered by the commit on <a href="https://travis-ci.org/opfab/operatorfabric-core/branches">Travis CI</a>.
The build job should have the following three stages:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/running_build.png" alt="Running build status page screenshot">
</div>
</div>
<div class="paragraph">
<p>Wait for the build to complete (around 30 minutes).</p>
</div>
</li>
<li>
<p>Check that the X.X.X.RELEASE images have been generated and pushed to DockerHub.</p>
</li>
<li>
<p>Check that the latest images have been updated on DockerHub.</p>
</li>
<li>
<p>Check that the documentation has been generated and pushed to the GitHub pages website (check version and revision
date at the top of document)</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You won&#8217;t be able to access it from the homepage until you have <a href="#in-the-documentation-repository-opfab-github-io">updated the _version.yml file</a> in the opfab.github.io
repository, so instead you can just type <a href="https://opfab.github.io/documentation/X.X.X.RELEASE/developer_guide/" class="bare">opfab.github.io/documentation/X.X.X.RELEASE/developer_guide/</a> in your browser.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Check that the tag was correctly pushed to GitHub and is visible under the
<a href="https://github.com/opfab/operatorfabric-core/releases">releases page</a> for the repository.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="checking-deploy-docker-compose">1.2.2. Checking deploy docker-compose</h4>
<div class="paragraph">
<p>The deploy docker-compose file should always rely on the latest RELEASE version
available on DockerHub. Once the CI pipeline triggered by the previous steps has completed successfully,
and you can see X.X.X.RELEASE images for all services on DockerHub, you should:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Remove your locally built X.X.X.RELEASE images if any</p>
</li>
<li>
<p>Run each of the two docker-compose files to make sure they pull the images from DockerHub and behave as intended.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="in-the-documentation-repository-opfab-github-io">1.2.3. In the documentation repository (opfab.github.io)</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the _data/versions.yml file:</p>
<div class="ulist">
<ul>
<li>
<p>Change:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>- name: X.X.X
  fullname: X.X.X.SNAPSHOT
  badges:
  - name: SNAPSHOT
    style: badge-snapshot</code></pre>
</div>
</div>
<div class="paragraph">
<p>to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>- name: X.X.X
  fullname: X.X.X.RELEASE
  badges:
  - name: RELEASE
    style: badge-release
  - name: CURRENT
    style: badge-current</code></pre>
</div>
</div>
</li>
<li>
<p>Then remove the following lines from the previous release version:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>  - name: CURRENT
    style: badge-current</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Commit and push changes</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="in-jira">1.2.4. In Jira</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set all concerned tickets (US, BUG, FR) and set fix version to X.X.X.RELEASE</p>
</li>
<li>
<p>In the "Releases" screen release X.X.X.RELEASE version</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="advertising-the-new-release-opfab-github-io-and-mailing-list">1.3. Advertising the new release (opfab.github.io and mailing list)</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the appropriate version from
<a href="https://opfab.atlassian.net/projects/OC?orderField=RANK&amp;selectedItem=com.atlassian.jira.jira-projects-plugin%3Arelease-page&amp;status=all">JIRA the release list</a>
to get the release notes (click "Release notes" under the version name at the top) listing new features, fixed bugs etc&#8230;&#8203;</p>
<div class="imageblock">
<div class="content">
<img src="images/release_notes.png" alt="Release notes link">
</div>
</div>
</li>
<li>
<p>Take this text and use it
to create a short post on the opfab.github.io repository (under _posts) announcing the release.
This post should highlight new features and necessary upgrade actions if any.</p>
</li>
<li>
<p>Send the same content as an email to the <a href="mailto:opfab-announce@lists.lfenergy.org">opfab-announce@lists.lfenergy.org</a> mailing list.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="preparing-next-version">1.4. Preparing next version</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You should wait for all the tasks associated with creating the X.X.X.RELEASE
version to finish and make sure that they&#8217;ve had the expected output before starting the
preparation of the next version. This is because any committed/pushed changes preparing the
new version will make rolling back or correcting any mistake on the release more complicated.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To prepare a next version you simply need to increment the version after a release (see <a href="#version-numbers">Version numbers</a>).</p>
</div>
<div class="sect3">
<h4 id="in-the-source-repository-operatorfabric-core-2">1.4.1. In the source repository (operatorfabric-core)</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use the ./CICD/prepare_snapshot_version.sh script to automatically perform all the necessary changes:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>./CICD/prepare_snapshot_version.sh --version Y.Y.Y.SNAPSHOT</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will perform the following changes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Replace all occurrences of X.X.X.RELEASE by Y.Y.Y.SNAPSHOT <strong>EXCEPT</strong> in the deploy docker-compose file
(src/main/docker/deploy/docker-compose.yml). The files concerned are *.adoc,
swagger.yaml files and the VERSION file at the root operatorfabric-core folder.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The VERSION file is particularly important as the CI/CD pipeline tasks
(building the documentation and the docker images for example) are based on it.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If no --version parameter is provided to the script, the new version will be the next minor version.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Add a Y.Y.Y.RELEASE.adoc file (blank except for copyright and title) under src/docs/asciidoc/release_notes to initialize the release
notes for next version.</p>
</li>
<li>
<p>Edit src/docs/asciidoc/release_notes/index.adoc to include this new file (before the previous versions so it appears on top).</p>
</li>
<li>
<p>Commit and push changes with the following message:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[PREPARE] next version: Y.Y.Y.SNAPSHOT</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="in-the-documentation-repository-opfab-github-io-2">1.4.2. In the documentation repository (opfab.github.io)</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the _data/versions.yml file, add the Y.Y.Y.SNAPSHOT version</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>- name: Y.Y.Y
  fullname: Y.Y.Y.SNAPSHOT
  badges:
  - name: SNAPSHOT
    style: badge-snapshot</code></pre>
</div>
</div>
</li>
<li>
<p>Commit and push changes.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="in-jira-2">1.4.3. In Jira</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the "Releases" screen create a  Y.Y.Y.RELEASE version.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="checking-dockerhub-the-following-day">1.4.4. Checking DockerHub the following day</h4>
<div class="paragraph">
<p>A CRON Travis job runs daily (the time of the day may vary) and generates the documentation and docker snapshot images.
After you have finished switching to the Y.Y.Y.SNAPSHOT version, you should wait for such a job to run and check that
the snapshot images are correctly generated and pushed on DockerHub.</p>
</div>
</div>
</div>
</div>
</div>
  </div>

</article>

    </div>
</div>

<a href="https://github.com/johncarl81/transfuse"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub" /></a>

<div id="footer">
</div>

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-11587475-2', 'auto');
    ga('send', 'pageview');

    //twitter button
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");

    //google +1 button
    (function() {
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();

    function setupToggle(expanded, toggleId, toggleBodyId){

        var updateArrows = function() {
            updateArrowCss(expanded ? 'arrowdown' : 'arrowright');
        }

        var updateArrowCss = function updateArrowCss(classifier){
            $(toggleId).removeClass('arrowright');
            $(toggleId).removeClass('arrowdiag');
            $(toggleId).removeClass('arrowdown');
            $(toggleId).addClass(classifier);
        }

        if(expanded){
            $(toggleBodyId).show();
        }
        else{
            $(toggleBodyId).hide();
        }
        updateArrows();

        $(toggleId).mousedown(function() {
            updateArrowCss('arrowdiag');
        });

        $(toggleId).mouseout(function() {
            updateArrows();
        });

        $(toggleId).click(function() {
            if(expanded){
                $(toggleBodyId).slideUp();
            }
            else{
                $(toggleBodyId).slideDown();
            }
            expanded = !expanded;
            updateArrows();
        });
    }

    setupToggle(, '#documentationtoggle', '#documentation');
    setupToggle(, '#poststoggle', '#posts');

</script>
</body>
</html>
